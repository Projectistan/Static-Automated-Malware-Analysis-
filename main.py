from tkinter import *
from tkinter import filedialog

from tkinter import ttk

import learning
import threading
import analyse

Loc=None
Loc1=None


root = Tk()
root.title('Malware Detection')
root.minsize(600, 400)
root.geometry("1200x800")
root.resizable(False,False)

background_image = PhotoImage(file="img.png")
background_label = Label(root, image=background_image)
background_label.place(x=0, y=0, relwidth=1, relheight=1)
background_label.image = background_image


def getFileLoc():
    global Loc
    Loc = filedialog.askopenfilename(title='select a .csv file', filetypes=(('csv files','*.csv'),('all files', '*.*')))
    return str(Loc)

def getFileLoc1():
    global Loc1
    Loc1 = filedialog.askopenfilename(title='select a .exe file', filetypes=(('exe files','*.exe'),('all files', '*.*')))
    return str(Loc1)

def trainpath():
    global trainpathloc
    trainpathloc = learning.learning1(Loc, processVar)
    return str(trainpathloc)
def mthread():
    threading.Thread(target=trainpath).start()

def analysepath():
    global trainpathloc
    trainpathloc = analyse.filepath(Loc1, processVar1)
    return str(trainpathloc)
def athread():
    threading.Thread(target=analysepath).start()

def close():
   root.destroy()
   root.quit()



titleLabel = Label(root, text="Malware Detection Using machine Learning", anchor=CENTER, bg="#4b76b4",fg="#c7d2e6",font=("Helvetica", 26))
titleLabel.grid(row=1, column=2, columnspan=4,sticky="w",padx=20,ipadx=200,pady=20,ipady=40)



datasetLb=Label(root,width=50,height=1,bg="#c7d2e6",fg="#050505",text=" Select Your dataset",font=("Calibri", 12))
datasetLb.grid(row=3,column=1,columnspan=2)

datasetBt = Button(root, text='Dataset',fg="black",bg="#a6776d",width=20,height=2, font=("Calibri", 13),command= getFileLoc)
datasetBt.grid(row=3, column=2,columnspan=2, padx=400, pady=20)


trainLb=Label(root,width=52,bg="#c7d2e6",fg="#050505",text="Train the Model with Dataset",height=1,font=("Calibri", 12))
trainLb.grid(row=4, column=1, columnspan=2)

trainBt = Button(root, text = 'Train Model', fg="black",bg="#a6776d",width=20,height=2,font=("Calibri", 13), command=mthread)
trainBt.grid(row=4, column=2,columnspan=2, pady=20, padx=20)

processVar = StringVar(value="")
processsLabel = Label(root, textvar=processVar, fg="black", bg="white")
processsLabel.grid(row=5, column=2, columnspan=2, pady=20, padx=20)



selectfileLb=Label(root,bg="#c7d2e6",fg="#050505",text="Select a File To Analyse", width=52,height=1,font=("Calibri", 12))
selectfileLb.grid(row=6, column=1, columnspan=2)

selectfileBt = Button(root, text = 'Select File',fg="black",bg="#a6776d",width=20,height=2,font=("Calibri", 13),command=getFileLoc1)
selectfileBt.grid(row=6, column=2,columnspan=2, pady=20, padx=20)


analysefileLb=Label(root,bg="#c7d2e6",fg="#050505",text="Analyse the File", width=52,height=1,font=("Calibri", 12))
analysefileLb.grid(row=7, column=1, columnspan=2)

analysefileBt = Button(root, text = 'Analyse File',fg="black",bg="#a6776d",width=20,height=2,font=("Calibri", 13), command=athread)
analysefileBt.grid(row=7, column=2,columnspan=2, pady=20, padx=20)

processVar1 = StringVar(value="")
processsLabel = Label(root, textvar=processVar1, fg="black", bg="white")
processsLabel.grid(row=8, column=2, columnspan=2, pady=20, padx=20)

closeBt = Button(root, text = 'Exit',fg="black",bg="#ce3531",width=10,height=1,font=("Calibri", 13), command=close)
closeBt.grid(row=9, column=2,columnspan=2, pady=20, padx=20)


root.mainloop()